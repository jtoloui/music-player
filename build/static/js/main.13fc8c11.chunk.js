(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{49:function(e,a,t){e.exports=t(86)},54:function(e,a,t){},55:function(e,a,t){},72:function(e,a,t){},77:function(e,a,t){},78:function(e,a,t){},81:function(e,a,t){},82:function(e,a,t){},83:function(e,a,t){},84:function(e,a,t){},86:function(e,a,t){"use strict";t.r(a);var c=t(0),r=t.n(c),n=t(24),l=t.n(n),i=(t(54),t(29)),_=t(5),m=(t(55),t(4)),s=t(3),o=Object(c.createContext)(),u={tracks:[],currentTrack:{},loading:!1,status:"out-of-sync",error:null},d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case"GET_TRACKS":e=Object(s.a)(Object(s.a)({},e),{},{tracks:e.tracks.concat(a.payload)});break;case"EMPTY_TRACKS":e=Object(s.a)(Object(s.a)({},e),{},{tracks:u.tracks});break;case"PLAY_TRACK":e=Object(s.a)(Object(s.a)({},e),{},{currentTrack:Object(s.a)({},a.payload)});break;case"SET_TRACK_DURATION":e=Object(s.a)(Object(s.a)({},e),{},{currentTrack:Object(s.a)(Object(s.a)({},e.currentTrack),{},{duration:a.payload})});break;case"START":e=Object(s.a)(Object(s.a)({},e),{},{loading:!0});break;case"COMPLETE":e=Object(s.a)(Object(s.a)({},e),{},{loading:!1});break;case"SYNCED":e=Object(s.a)(Object(s.a)({},e),{},{status:"synced"});break;case"NOT-SYNCED":e=Object(s.a)(Object(s.a)({},e),{},{status:"out-of-sync"})}return Object(s.a)({},e)},p=function(e){var a=Object(c.useReducer)(d,u),t=Object(m.a)(a,2),n=t[0],l=t[1];return r.a.createElement(o.Provider,{value:[n,l]},e.children)},b=t(99),y=t(19),f=t.n(y),E=(t(72),t(46)),v=t(15),k=t(13),O=(t(77),function(e){var a=e.title,t=e.album,n=Object(E.a)(e,["title","album"]),l=Object(c.useContext)(o),i=Object(m.a)(l,2),_=i[0],u=i[1],d=Object(c.useState)(!1),p=Object(m.a)(d,2),b=p[0],y=p[1],O=Object(c.useState)("visible"),N=Object(m.a)(O,2),h=N[0],j=N[1],g=Object(c.useState)(k.b),T=Object(m.a)(g,2),C=T[0],w=T[1],S=Object(c.useRef)(),x=Object(c.useRef)();Object(c.useEffect)((function(){_.currentTrack&&S.current&&(_.currentTrack._id===S.current.id?(y(!0),w(k.e),j("hidden")):(y(!1),w(k.b),j("visible")))}),[_.currentTrack]);return r.a.createElement("div",{className:"media-player__music-player__music-tracks"},r.a.createElement("div",{className:"media-player__music-player__music-tracks__container"},r.a.createElement("div",{className:"media-player__music-player__music-tracks__container__album"}),r.a.createElement("div",{className:"media-player__music-player__music-tracks__container__track-info"},r.a.createElement("div",{className:"media-player__music-player__music-tracks__container__track-info__title"},a),r.a.createElement("div",{className:"media-player__music-player__music-tracks__container__track-info__audio-length"},t)),r.a.createElement("button",{className:"media-player__music-player__music-tracks__container__remove-button",id:n._id,onClick:function(){var e;e=x.current.id,f.a.delete("http://localhost:3001/api/track/".concat(e)).then((function(e){u({type:"NOT-SYNCED"})})).catch((function(e){throw e}))},disabled:b,ref:x},r.a.createElement(v.a,{visibility:h,id:"play-button",icon:k.d,color:"grey"})),r.a.createElement("button",{className:"media-player__music-player__music-tracks__container__play-button",id:n._id,onClick:function(){var e;e=Object(s.a)({title:a,album:t},n),u({type:"PLAY_TRACK",payload:e})},disabled:b,ref:S},r.a.createElement(v.a,{id:"play-button",icon:C,color:"#a237f3"}))))});t(78);var N=function(e){var a=e.title,t=e.album,n=Object(c.useContext)(o),l=Object(m.a)(n,2),i=l[0],_=l[1],s=Object(c.useState)(!0),u=Object(m.a)(s,2),d=u[0],p=u[1],y=Object(c.useState)(!1),f=Object(m.a)(y,2),E=f[0],O=f[1],N=Object(c.useState)(0),h=Object(m.a)(N,2),j=h[0],g=h[1],T=E?"grey":"#a237f3",C=d?"grey":"#a237f3",w=Object(c.useRef)(),S=Object(c.useRef)(),x=function(e){var a=1e3*e,t=a?Math.floor(a/6e4):"-",c=a?(a%6e4/1e3).toFixed(0):"--";return"".concat(t,":").concat(c<10?"0":"").concat(c)},A=x(j),R=x(i.currentTrack.duration),P=document.querySelector("progress");Object(c.useEffect)((function(){P&&P.addEventListener("click",K)}),[P]),Object(c.useEffect)((function(){w.current.onloadedmetadata=function(e){_({type:"SET_TRACK_DURATION",payload:w.current.duration})},w.current.ontimeupdate=function(){D()},i.currentTrack.duration?(p(!0),O(!1)):(p(!0),O(!0))}),[_,i.currentTrack.duration]);var D=function(){g(w.current.currentTime)};function K(e){var a=e.offsetX/this.offsetWidth;w.current.currentTime>0&&(w.current.currentTime=a*w.current.duration,S.current.value=a/100)}return r.a.createElement("div",{className:"media-player__music-player__music-view"},r.a.createElement("div",{className:"media-player__music-player__music-view__container"},r.a.createElement(b.a,{container:!0,spacing:2},r.a.createElement(b.a,{item:!0,xs:12,md:3,lg:2},r.a.createElement("div",{className:"media-player__music-player__music-view__container__album"})),r.a.createElement(b.a,{item:!0,xs:12,md:9,lg:10},r.a.createElement("div",{className:"media-player__music-player__music-view__container__track-info"},r.a.createElement("div",{className:"media-player__music-player__music-view__container__track-info__title"},a),r.a.createElement("div",{className:"media-player__music-player__music-view__container__track-info__subtitle"},t),r.a.createElement(b.a,{item:!0,md:12},r.a.createElement("progress",{ref:S,className:"media-player__music-player__music-view__container__track-info__progress-bar",id:"audio-progress",value:j,max:i.currentTrack.duration&&i.currentTrack.duration}),r.a.createElement("audio",{className:"media-player__music-player__music-view__container__track-info__audio",src:i.currentTrack.fileLocation&&"http://localhost:3001/".concat(i.currentTrack.fileLocation),ref:w,type:i.currentTrack.fileType&&i.currentTrack.fileType})),r.a.createElement("div",{className:"media-player__music-player__music-view__container__track-info__timing"},r.a.createElement(b.a,{item:!0,xs:6},r.a.createElement("div",{className:"media-player__music-player__music-view__container__track-info__timing__minutes"},A)),r.a.createElement(b.a,{item:!0,xs:6},r.a.createElement("div",{className:"media-player__music-player__music-view__container__track-info__timing__seconds"},R))))),r.a.createElement("hr",null),r.a.createElement(b.a,{item:!0,xs:12},r.a.createElement("div",{className:"media-player__music-player__music-view__container__controls"},r.a.createElement("button",{disabled:E,className:"media-player__music-player__music-view__container__controls__play",onClick:function(){return O(!0),p(!1),void w.current.play()}},r.a.createElement(v.a,{icon:k.b,color:T})),r.a.createElement("button",{disabled:d,className:"media-player__music-player__music-view__container__controls__pause",onClick:function(){return p(!0),O(!1),void w.current.pause()}},r.a.createElement(v.a,{icon:k.a,color:C})))))))},h=t(17);t(81),t(82);var j=function(e){var a=e.label,t=e.name,c=e.type,n=e.labelClass,l=e.inputClass,i=e.register,_=e.validation,m=e.errors,o=e.accepts;return r.a.createElement("div",{className:"media-player__form__input"},r.a.createElement("label",{htmlFor:t,className:"media-player__form__input__label ".concat(n)},a),r.a.createElement("br",null),r.a.createElement("input",{type:c,name:t,className:"media-player__form__input__".concat(c," ").concat(l),accept:o,ref:i(Object(s.a)({},_))}),m&&m.hasOwnProperty(t)&&r.a.createElement("div",{className:"media-player__form__input__error-message"},r.a.createElement(h.b,{errors:m,name:t})))};t(83);var g=function(e){var a=e.name,t=e.label,c=e.accept,n=e.register,l=e.labelClass,i=e.validation,_=e.onChange,m=document.querySelector(".media-player__form__file-input");return r.a.useEffect((function(){m&&function(e){var a=e.querySelector('[type="file"]'),t=e.querySelector("[data-js-label]");a.onchange=a.onmouseout=function(){if(a.value){var c=a.value.replace(/^.*[\\/]/,"");a.setAttribute("value",a.value.replace(/C:\\fakepath\\/g,"")),e.className+=" -chosen",t.innerText=c}}}(m)}),[m]),r.a.createElement("div",{className:"media-player__form__file-input"},r.a.createElement("label",{htmlFor:a,className:"media-player__form__input__label ".concat(l)},t),r.a.createElement("br",null),r.a.createElement("input",{type:"file",name:a,id:"track",accept:c,ref:n(Object(s.a)({},i)),onChange:_}),r.a.createElement("span",{className:"button"},"Choose"),r.a.createElement("span",{className:"label","data-js-label":!0},"No file selected"))},T=function(e){var a=e.onDismiss,t=Object(h.c)({mode:"onChange"}),n=t.register,i=t.control,_=t.handleSubmit,s=t.errors,u=Object(c.useContext)(o),d=Object(m.a)(u,2)[1];return l.a.createPortal(r.a.createElement("form",{onSubmit:_((function(e){var t=new FormData;t.set("label",e.label),t.set("album",e.album),t.append("track",e.track[0]),f.a.post("http://localhost:3001/api/track",t,{headers:{"Content-Type":"multipart/form-data"}}).then((function(e){d({type:"NOT-SYNCED"}),a()})).catch((function(e){return console.log(e)}))})),onKeyPress:function(e){13===(e.keyCode?e.keyCode:e.which)&&e.preventDefault()}},r.a.createElement("div",{className:"media-player__modal"},r.a.createElement("div",{className:"media-player__modal__content"},r.a.createElement("div",{className:"media-player__modal__content__heading"},"Upload a new Track"),r.a.createElement(b.a,{container:!0},r.a.createElement(b.a,{item:!0,xs:12,md:6},r.a.createElement(b.a,{item:!0,xs:12},r.a.createElement(h.a,{as:j,name:"label",label:"Track Name",type:"text",control:i,defaultValue:"",labelClass:"media-player__modal__content__track-label",inputClass:"media-player__modal__content__track-label__input",register:n,validation:{required:"Please provide a track name"},errors:s}),r.a.createElement(h.a,{as:j,control:i,defaultValue:"",type:"text",label:"Album name",name:"album",labelClass:"media-player__modal__content__track-album",inputClass:"media-player__modal__content__track-album__input",register:n}))),r.a.createElement(b.a,{item:!0,xs:12,md:6},r.a.createElement(b.a,{item:!0,xs:12},r.a.createElement("div",{className:"media-player__modal__content__uploader__container"},r.a.createElement(h.a,{label:"Please choose your track",as:g,control:i,defaultValue:"",type:"file",name:"track",id:"track",accept:"audio/*",register:n,labelClass:"media-player__modal__content__track-file"}))),r.a.createElement("div",{className:"media-player__modal__content__buttons"},r.a.createElement("button",{onClick:function(){return a()},className:"media-player__modal__content__buttons__close"},"Cancel"),r.a.createElement("button",{className:"media-player__modal__content__buttons__upload"},"Upload"))))))),document.querySelector("#modal"))},C=(t(84),function(e){return r.a.createElement("div",{className:"media-player__add-track"},r.a.createElement("label",null,"Add a song"),r.a.createElement("button",{className:"media-player__add-track__button",onClick:e.onClick},r.a.createElement(v.a,{id:"add-button",icon:k.c,color:"#a237f3"})))}),w=function(){var e=Object(c.useContext)(o),a=Object(m.a)(e,2),t=a[0],n=a[1],l=Object(c.useState)(!1),i=Object(m.a)(l,2),_=i[0],s=i[1];Object(c.useEffect)((function(){"out-of-sync"===t.status&&f.a.get("http://localhost:3001/api/track").then((function(e){n({type:"START"}),n({type:"EMPTY_TRACKS"}),n({type:"GET_TRACKS",payload:e.data.track}),n({type:"SYNCED"}),n({type:"COMPLETE"})})).catch((function(e){throw e}))}),[n,t.status]);var u=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],a=document.querySelector("#modal");a&&e&&(a.classList.add("active"),s(e)),a&&!e&&(a.classList.remove("active"),s(e))};return r.a.createElement("div",{className:"media-player__wrapper"},r.a.createElement("div",{className:"media-player__wrapper__heading"},r.a.createElement("div",{className:"media-player__wrapper__heading__title"},"My Music Player"),r.a.createElement("div",{className:"media-player__wrapper__heading__add-track-heading"},r.a.createElement(C,{onClick:u}))),r.a.createElement("div",{className:"media-player__wrapper__music-player"},r.a.createElement(b.a,{container:!0,spacing:2},r.a.createElement(b.a,{item:!0,xs:12,sm:6,md:8,lg:7},r.a.createElement(N,{title:t.currentTrack.title||"Please select a track",album:t.currentTrack.album||"Please select a track"})),r.a.createElement(b.a,{item:!0,xs:12,sm:6,md:4,lg:5},r.a.createElement("div",{className:"media-player__wrapper__music-player__tracks"},"fetching"!==t.loading&&t.tracks.length>0&&t.tracks.map((function(e){return r.a.createElement(O,Object.assign({key:e._id,title:e.label,album:e.album},e))}))))),_&&r.a.createElement(T,{onDismiss:function(){return u(!1)}})))},S=function(e){var a=e.location;return r.a.createElement("div",{className:"wrong-path"},r.a.createElement("div",{className:"wrong-path__heading"},r.a.createElement("h1",null,"Whoops!")),r.a.createElement("div",{className:"wrong-path__body"},r.a.createElement("h3",null,"No match for ",r.a.createElement("code",null,a.pathname)),r.a.createElement(i.b,{className:"wrong-path__body__button",to:"/player"},"Home")))},x=function(){return r.a.createElement("div",{className:"media-player"},r.a.createElement(i.a,null,r.a.createElement(p,null,r.a.createElement(_.d,null,r.a.createElement(_.a,{exact:!0,from:"/",to:"/player"}),r.a.createElement(_.b,{path:"/player",exact:!0,component:w}),r.a.createElement(_.b,{component:S})))))};l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(x,null)),document.getElementById("root"))}},[[49,1,2]]]);